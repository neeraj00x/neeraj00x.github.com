<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A Question for You...</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
      body {
        font-family: "Poppins", sans-serif;
        overflow: hidden;
      }

      .script-font {
        font-family: "Great Vibes", cursive;
      }

      .floating-heart {
        position: absolute;
        color: rgba(255, 182, 193, 0.6);
        animation: float 15s infinite linear;
        z-index: 0;
        pointer-events: none;
      }

      @keyframes float {
        0% { transform: translateY(100vh) rotate(0deg); opacity: 1; }
        100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
      }

      .fade-in { animation: fadeIn 1.5s ease-in forwards; }
      .fade-out { animation: fadeOut 1s ease-out forwards; }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      @keyframes fadeOut {
        from { opacity: 1; transform: translateY(0); }
        to { opacity: 0; transform: translateY(-20px); }
      }

      .heartbeat { animation: beat 1.2s infinite; }
      @keyframes beat {
        0%, 100% { transform: scale(1); }
        25% { transform: scale(1.1); }
        50% { transform: scale(1); }
        75% { transform: scale(1.1); }
      }

      /* Pulse effect for the save button */
      .pulse-button {
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(236, 72, 153, 0); }
        100% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0); }
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-pink-100 via-red-50 p-8 to-pink-200 h-screen w-screen flex flex-col items-center justify-center relative select-none">
    
    <div id="hearts-container" class="absolute inset-0 overflow-hidden"></div>
	
	<audio id="bg-music" loop>
      <source src="val.mp3" type="audio/mpeg">
    </audio>
	
    <div id="intro-card" class="z-10 text-center max-w-lg p-8 bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-pink-100 transition-all duration-700">
      <h1 class="text-3xl text-pink-600 mb-6 font-semibold" id="intro-text">Hey Beautiful...</h1>
      <button onclick="startExperience()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105 focus:outline-none ring-4 ring-pink-200">
        Click Me
      </button>
    </div>

    <div id="question-card" class="hidden z-10 text-center max-w-2xl p-6 md:p-12 relative">
      <div class="text-6xl md:text-8xl text-red-500 mb-4 heartbeat drop-shadow-md">‚ù§Ô∏è</div>
      <h1 class="script-font text-5xl md:text-7xl text-pink-600 mb-4 leading-tight">Will you be my Valentine?</h1>
      <p class="text-gray-600 mb-10 text-lg md:text-xl">(I promise to buy you chocolate üç´)</p>
      <div class="flex justify-center gap-4 md:gap-8 items-center h-20">
        <button id="yes-btn" onclick="acceptProposal()" class="bg-green-500 hover:bg-green-600 text-white text-xl font-bold py-4 px-10 rounded-full shadow-lg transform transition hover:scale-110 ring-4 ring-green-200 z-20">
          YES!
        </button>
        <button id="no-btn" onmouseover="dodgeButton()" onclick="dodgeButton()" class="bg-gray-400 text-white text-xl font-bold py-4 px-10 rounded-full shadow-lg transition" style="transition: all 0.2s ease">
          No
        </button>
      </div>
    </div>

    <div id="success-card" class="hidden z-10 text-center max-w-2xl p-8 bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border-4 border-pink-300">
      <h1 class="text-6xl md:text-8xl mb-4">ü•∞üéâ</h1>
      <h2 class="script-font text-5xl md:text-7xl text-pink-600 mb-6">You just said YES!</h2>
      <p class="text-xl text-gray-700 font-medium">
        You just made me the happiest person in the world. <br />
        I love you! ‚ù§Ô∏è
      </p>
      
      <button onclick="takeScreenshot()" class="mt-8 pulse-button bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105 flex items-center justify-center gap-2 mx-auto">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
        </svg>
        Save Our Moment
      </button>

      <div class="mt-4 text-sm text-gray-400 italic">
        Click to download and send it back to me!
      </div>
    </div>

    <script>
      let step = 0;
      const messages = [
        "Hey Beautiful...",
        "We've made so many memories...",
        "You make me smile every single day...",
        "So I have a question...",
      ];
	  
	  const music = document.getElementById("bg-music");

      // Starts the music and transitions text
      function startExperience() {
		music.volume = 0.5;
        music.play().catch(e => console.log("Audio play blocked until interaction"));
        nextStep();
      }

      const introCard = document.getElementById("intro-card");
      const introText = document.getElementById("intro-text");
      const questionCard = document.getElementById("question-card");
      const successCard = document.getElementById("success-card");
      const noBtn = document.getElementById("no-btn");
      const yesBtn = document.getElementById("yes-btn");
      let yesScale = 1;

      function nextStep() {
        step++;
        introText.classList.add("fade-out");
        setTimeout(() => {
          if (step < messages.length) {
            introText.innerText = messages[step];
            introText.classList.remove("fade-out");
            introText.classList.add("fade-in");
          } else {
            introCard.classList.add("hidden");
            questionCard.classList.remove("hidden");
            questionCard.classList.add("fade-in");
          }
        }, 500);
      }

      function dodgeButton() {
        yesScale += 0.2;
        yesBtn.style.transform = `scale(${yesScale})`;
        const maxX = window.innerWidth - noBtn.offsetWidth - 50;
        const maxY = window.innerHeight - noBtn.offsetHeight - 50;
        const randomX = Math.random() * maxX;
        const randomY = Math.random() * maxY;
        noBtn.style.position = "absolute";
        noBtn.style.left = randomX + "px";
        noBtn.style.top = randomY + "px";
      }

      function acceptProposal() {
        questionCard.classList.add("hidden");
        successCard.classList.remove("hidden");
        successCard.classList.add("fade-in");
        launchConfetti();
        let duration = 5 * 1000;
        let animationEnd = Date.now() + duration;
        let interval = setInterval(function () {
          let timeLeft = animationEnd - Date.now();
          if (timeLeft <= 0) return clearInterval(interval);
          launchConfetti();
        }, 300);
      }

      function launchConfetti() {
        confetti({
          particleCount: 150,
          spread: 100,
          origin: { y: 0.6 },
          colors: ["#ff69b4", "#ff0000", "#ffffff"],
          shapes: ["heart"],
        });
      }

      // --- SCREENSHOT LOGIC ---
      function takeScreenshot() {
        const element = document.getElementById("success-card");
        
        // Temporarily remove animation classes for a clean shot
        element.classList.remove("fade-in");
        
        html2canvas(element, {
          backgroundColor: null,
          scale: 2,
          logging: false,
          useCORS: true
        }).then((canvas) => {
          const image = canvas.toDataURL("image/png");
          const link = document.createElement("a");
          link.href = image;
          link.download = "Our_Valentine_Memory.png";
          link.click();
        });
      }

      function createFloatingHeart() {
        const heart = document.createElement("div");
        heart.classList.add("floating-heart");
        heart.innerHTML = "‚ù§Ô∏è";
        heart.style.left = Math.random() * 100 + "vw";
        heart.style.fontSize = Math.random() * 20 + 10 + "px";
        heart.style.animationDuration = Math.random() * 10 + 10 + "s";
        document.getElementById("hearts-container").appendChild(heart);
        setTimeout(() => heart.remove(), 20000);
      }
      setInterval(createFloatingHeart, 500);
    </script>
  </body>

</html>
